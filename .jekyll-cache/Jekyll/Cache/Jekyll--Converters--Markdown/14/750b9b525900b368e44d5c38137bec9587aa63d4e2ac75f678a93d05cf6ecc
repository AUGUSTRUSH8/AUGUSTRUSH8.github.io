I"¡<h2 id="ctpnæ˜¯ä»€ä¹ˆ">CTPNæ˜¯ä»€ä¹ˆ</h2>
<p>CTPNç»“åˆCNNä¸LSTMæ·±åº¦ç½‘ç»œï¼ŒCTPNæ˜¯ä»Faster R-CNNæ”¹è¿›è€Œæ¥ï¼Œèƒ½æœ‰æ•ˆçš„æ£€æµ‹å‡ºå¤æ‚åœºæ™¯çš„æ¨ªå‘åˆ†å¸ƒçš„æ–‡å­—ï¼Œæ•ˆæœå¦‚å›¾1ï¼Œæ˜¯ç›®å‰æ¯”è¾ƒå¥½çš„æ–‡å­—æ£€æµ‹ç®—æ³•ã€‚è¯¦ç»†è§£é‡Šï¼š<a href="https://zhuanlan.zhihu.com/p/34757009">ä¼ é€é—¨</a>
<img src="https://upload-images.jianshu.io/upload_images/10780978-009e5f5c05cdf909.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" class="center" />
è¯´äººè¯ï¼šæ–‡å­—è¯†åˆ«çš„å‰æœŸå·¥ä½œï¼Œéœ€è¦æŠŠå›¾ç‰‡ä¸­çš„æ–‡å­—åŒºåŸŸå®šä½å‡ºæ¥ï¼Œç„¶åå¯ä»¥åšé€‚å½“çš„è£åˆ‡ä½œè¿›ä¸€æ­¥çš„æ–‡å­—è¯†åˆ«å·¥ä½œï¼</p>

<h2 id="æœ¬æ¬¡è¦å®ç°çš„é¡¹ç›®">æœ¬æ¬¡è¦å®ç°çš„é¡¹ç›®</h2>
<p>åœ°å€å¦‚ä¸‹ï¼ˆåˆ«ç€æ€¥å…‹éš†ï¼‰ï¼š</p>
<blockquote>
  <p>https://github.com/eragonruan/text-detection-ctpn</p>
</blockquote>

<p><img src="https://upload-images.jianshu.io/upload_images/10780978-566da9acd2ca82ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" class="center" /></p>
<h2 id="é¡¹ç›®è¦å®ç°çš„æ•ˆæœ">é¡¹ç›®è¦å®ç°çš„æ•ˆæœ</h2>
<p><img src="https://upload-images.jianshu.io/upload_images/10780978-5d36504ae0bc8cae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" class="center" />
<img src="https://upload-images.jianshu.io/upload_images/10780978-766026deb693123b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" class="center" /></p>

<h2 id="ç¬¬ä¸€æ­¥å…‹éš†é¡¹ç›®">ç¬¬ä¸€æ­¥â€“å…‹éš†é¡¹ç›®</h2>
<p>æˆ‘å…‹éš†çš„æ˜¯ä¸‹é¢è¿™ä¸ªé¡¹ç›®ï¼Œä»–æœ‰è®­ç»ƒå¥½çš„æƒé‡æ–‡ä»¶ï¼š</p>
<blockquote>
  <p>https://github.com/GuoYi0/text_detection</p>
</blockquote>

<h2 id="ç¬¬äºŒæ­¥å¼€å§‹è·‘demo">ç¬¬äºŒæ­¥â€“å¼€å§‹è·‘demo</h2>
<p>ç»“æœç¢°åˆ°äº†ä¸‹é¢è¿™ä¸ªé”™è¯¯ï¼š</p>
<blockquote>
  <p>ImportError: cannot import name â€˜bboxâ€™</p>
</blockquote>

<p>å›å»æ‰¾issueï¼Œæœç„¶æœ‰äººè·Ÿæˆ‘ä¸€æ ·ï¼Œæ‰çœ‹åŠæˆªå°±å¼€è·‘
issueåœ°å€ï¼šhttps://github.com/eragonruan/text-detection-ctpn/issues/59
ä¸‹é¢æœ‰äººç»™å‡ºäº†ç­”æ¡ˆï¼š
<img src="https://upload-images.jianshu.io/upload_images/10780978-d648ee1eedca7b06.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" /></p>

<p>ç…§ç€åšï¼Œå†è·‘ä¸€æ¬¡ï¼Œä½†æ˜¯ï¼Œï¼Œï¼Œè¿˜æ˜¯
<img src="https://upload-images.jianshu.io/upload_images/10780978-9ee6aedf64a9a112.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" class="center" />
another errorï¼š</p>

<blockquote>
  <p>Invalid argument: ValueError: Buffer dtype mismatch, expected â€˜int_tâ€™ but got â€˜long longâ€™</p>
</blockquote>

<p>å†å»æ‰¾è§£å†³æ–¹æ¡ˆã€‚æ‰¾åˆ°äº†ä¸‹é¢è¿™ä¸ªï¼š
issueåœ°å€ï¼šhttps://github.com/eragonruan/text-detection-ctpn/issues/59
è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼ˆæˆ‘åªæ˜¯éƒ¨åˆ†ä¿®æ”¹ï¼ŒåŸä½œè€…æ˜¯ä»…ä½¿ç”¨CPUæ‰§è¡Œï¼‰</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>thanks to the author and [#43](https://github.com/eragonruan/text-detection-ctpn/issues/43) zhao181

my environment is:
windows10 ,
python3.6 ,
tensorflow1.3 ,
vs2015(ps:vs2013 not support python3.6 when compile)

step 1:make some change
change "np.int_t " to "np.intp_t" in line 25 of the file lib\utils\cython_nms.pyx
otherwise appear " ValueError: Buffer dtype mismatch, expected 'int_t' but got 'long long' " in step 6.

step 2:updata c file
execute:cd your_dir\text-detection-ctpn-master\lib\utils
execute:cython bbox.pyx
execute:cython cython_nms.pyx

step 3:builf setup file as setup_new.py
import numpy as np
from distutils.core import setup
from Cython.Build import cythonize
from distutils.extension import Extension
numpy_include = np.get_include()
setup(ext_modules=cythonize("bbox.pyx"),include_dirs=[numpy_include])
setup(ext_modules=cythonize("cython_nms.pyx"),include_dirs=[numpy_include])

step 4:build .pyd file
execute:python setup_new.py install
copy bbox.cp36-win_amd64.pyd and cython_nms.cp36-win_amd64.pyd to your_dir\text-detection-ctpn-master\lib\utils

step 5:make some change
(1) Set "USE_GPU_NMS " in the file \ctpn\text.yml as "False"
(2) Set the "_*C.USE_GPU_NMS" in the file \lib\fast_rcnn\config.py as "False";
(3) Comment out the line "from lib.utils.gpu_nms import gpu_nms" in the file \lib\fast_rcnn\nms_wrapper.py;
(4) Comment out the line "from . import gpu_nms" in the file \lib\utils_*init**.py;
(5) change "base_name = image_name.split('/')[-1]" to "base_name = image_name.split('\')[-1]" in line 24 of the file ctpn\demo.py

step 6:run demo
execute:cd your_dir\text-detection-ctpn-master
execute:python ./ctpn/demo.py

</code></pre></div></div>
<p>å…³é”®æ”¹åŠ¨éƒ¨åˆ†</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>step 1:make some change
change "np.int_t " to "np.intp_t" in line 25 of the file lib\utils\cython_nms.pyx
otherwise appear " ValueError: Buffer dtype mismatch, expected 'int_t' but got 'long long' " in step 6.
</code></pre></div></div>
<p>æˆ‘å†è·‘ä¸€æ¬¡æµ‹è¯•ï¼
ç»“æœï¼Œï¼Œï¼Œ
<img src="https://upload-images.jianshu.io/upload_images/10780978-6f6623873805bb95.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" class="center" />
é”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Loading network VGGnet_test...  Restoring from checkpoints/VGGnet_fast_rcnn_iter_50000.ckpt... done
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Demo for E:\business\recognition\text_detection\text-detection-ctpn\data\demo\010.png
Traceback (most recent call last):
  File "./ctpn/demo.py", line 101, in <span class="nt">&lt;module&gt;</span>
    ctpn(sess, net, im_name)
  File "./ctpn/demo.py", line 61, in ctpn
    draw_boxes(img, image_name, boxes, scale)
  File "./ctpn/demo.py", line 26, in draw_boxes
    with open('data/results/' + 'res_{}.txt'.format(base_name.split('.')[0]), 'w') as f:
OSError: [Errno 22] Invalid argument: 'data/results/res_E:\\business\\recognition\\text_detection\\text-detection-ctpn\\data\\demo\\010.txt'
</code></pre></div></div>
<p>å®šä½è¿™ä¸ªé—®é¢˜èŠ±äº†æˆ‘ä¸€ç‚¹æ—¶é—´ï¼Œå„ç§çŒœæƒ³ï¼Œæœ€åå†å›å¤´è¯¦ç»†è¯»ä¸€ä¸‹è¿™ä¸ªé”™è¯¯ä¿¡æ¯ï¼Œå‘ç°äº†é—®é¢˜æ‰€åœ¨ï¼Œæœ€åä¸€å¥ï¼å‚æ•°é”™è¯¯ï¼
å›å»æ”¹æºç ï¼š</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> base_name = image_name.split('\\')[-1]
    with open('data\\results\\' + 'res_{}.txt'.format(base_name.split('.')[0]), 'w') as f:
</code></pre></div></div>
<p>åªæƒ³è¯´ä¸€å¥ï¼ŒWindowsçš„<strong>â€œ\â€</strong>çœŸæ˜¯ã€‚ã€‚ã€‚
<img src="https://upload-images.jianshu.io/upload_images/10780978-703b07913d669a5d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" class="center" />
æˆ‘å†è·‘ï¼åŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹ 
<img src="https://upload-images.jianshu.io/upload_images/10780978-4a160c52fc49953d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" />
æŸ¥çœ‹è¾“å‡ºç»“æœç›®å½•
<img src="https://upload-images.jianshu.io/upload_images/10780978-31abe20089062227.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" class="center" />
æ¥ä¸‹æ¥å°±æ˜¯å»ç ”ç©¶åŸç†å’Œæºç äº†ï¼Œè¿™ä¸ªå¾—æ”¾ä¸€æ®µè½ï¼Œå…ˆæŠŠä¸šåŠ¡å®Œæˆå…ˆã€‚ã€‚ã€‚
<img src="https://upload-images.jianshu.io/upload_images/10780978-366f930dad8f4b77.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" class="center" /></p>

<p>å†è¡¥ä¸€å¥ï¼Œå¯¹è¿™ä¸ªæ„Ÿå…´è¶£çš„è¿˜å¯ä»¥å»ç ”ç©¶ä¸‹ä¸‹é¢è¿™ä¸ªé¡¹ç›®ï¼Œæä¾›äº†æ•°æ®é›†ç­‰</p>

<blockquote>
  <p>https://github.com/QAlexBall/Faster_RCNN_for_TextDetection</p>
</blockquote>
:ET